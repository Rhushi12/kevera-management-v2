<!-- Kevera Manufacturing - Enhanced Shared Layout -->
<aside class="w-80 lg:w-80 flex-shrink-0 bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 flex flex-col h-full transition-all duration-300 shadow-lg lg:shadow-none relative">
  <!-- Logo and Brand Section -->
  <div class="p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0">
    <div class="flex items-center gap-3">
      <div class="w-10 h-10 text-primary flex items-center justify-center bg-primary/10 rounded-xl">
        <svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" class="w-6 h-6">
          <g clip-path="url(#clip0_6_319)">
            <path d="M8.57829 8.57829C5.52816 11.6284 3.451 15.5145 2.60947 19.7452C1.76794 23.9758 2.19984 28.361 3.85056 32.3462C5.50128 36.3314 8.29667 39.7376 11.8832 42.134C15.4698 44.5305 19.6865 45.8096 24 45.8096C28.3135 45.8096 32.5302 44.5305 36.1168 42.134C39.7033 39.7375 42.4987 36.3314 44.1494 32.3462C45.8002 28.361 46.2321 23.9758 45.3905 19.7452C44.549 15.5145 42.4718 11.6284 39.4217 8.57829L24 24L8.57829 8.57829Z" fill="currentColor"></path>
          </g>
          <defs>
            <clipPath id="clip0_6_319"><rect fill="white" height="48" width="48"></rect></clipPath>
          </defs>
        </svg>
      </div>
      <div>
        <h2 class="text-xl font-bold text-gray-900 dark:text-white">Kevera</h2>
        <p class="text-xs text-gray-500 dark:text-gray-400">Manufacturing Suite</p>
      </div>
    </div>
  </div>
  
  <!-- Main Navigation -->
  <nav class="flex-1 py-4 overflow-y-auto" id="main-navigation">
    <!-- Temporary fallback navigation while JavaScript loads -->
    <div class="px-4 space-y-6">
      <!-- Manufacturing Process Section -->
      <div>
        <p class="text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-3 px-3">Manufacturing Process</p>
        <ul class="flex flex-col gap-y-1">
          <li>
            <a href="#/dashboard" class="nav-link block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white transition-all duration-200 border-l-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600" data-route="dashboard" role="menuitem">
              <div class="flex items-center">
                <span class="material-symbols-outlined mr-3 text-lg">dashboard</span>
                <span class="font-medium flex-1">Dashboard</span>
              </div>
            </a>
          </li>
          <li>
            <a href="#/intake" class="nav-link block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white transition-all duration-200 border-l-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600" data-route="intake" role="menuitem">
              <div class="flex items-center">
                <span class="material-symbols-outlined mr-3 text-lg">inbox</span>
                <span class="font-medium flex-1">Intake (Step 1)</span>
                <span class="text-xs bg-primary/10 text-primary px-2 py-1 rounded-full ml-2">Step 1</span>
              </div>
            </a>
          </li>
          <li>
            <a href="#/cutting" class="nav-link block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white transition-all duration-200 border-l-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600" data-route="cutting" role="menuitem">
              <div class="flex items-center">
                <span class="material-symbols-outlined mr-3 text-lg">cut</span>
                <span class="font-medium flex-1">Cutting & Bundling (Step 2)</span>
                <span class="text-xs bg-primary/10 text-primary px-2 py-1 rounded-full ml-2">Step 2</span>
              </div>
            </a>
          </li>
          <li>
            <a href="#/sewing" class="nav-link block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white transition-all duration-200 border-l-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600" data-route="sewing" role="menuitem">
              <div class="flex items-center">
                <span class="material-symbols-outlined mr-3 text-lg">styler</span>
                <span class="font-medium flex-1">Sewing (Step 3)</span>
                <span class="text-xs bg-primary/10 text-primary px-2 py-1 rounded-full ml-2">Step 3</span>
              </div>
            </a>
          </li>
          <li>
            <a href="#/ironing" class="nav-link block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white transition-all duration-200 border-l-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600" data-route="ironing" role="menuitem">
              <div class="flex items-center">
                <span class="material-symbols-outlined mr-3 text-lg">iron</span>
                <span class="font-medium flex-1">Ironing (Step 4)</span>
                <span class="text-xs bg-primary/10 text-primary px-2 py-1 rounded-full ml-2">Step 4</span>
              </div>
            </a>
          </li>
          <li>
            <a href="#/packaging" class="nav-link block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white transition-all duration-200 border-l-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600" data-route="packaging" role="menuitem">
              <div class="flex items-center">
                <span class="material-symbols-outlined mr-3 text-lg">package_2</span>
                <span class="font-medium flex-1">Labeling & Packaging (Step 5)</span>
                <span class="text-xs bg-primary/10 text-primary px-2 py-1 rounded-full ml-2">Step 5</span>
              </div>
            </a>
          </li>
        </ul>
      </div>
      
      <!-- Management Section -->
      <div>
        <p class="text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-3 px-3">Management</p>
        <ul class="flex flex-col gap-y-1">
          <li>
            <a href="#/lots" class="nav-link block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white transition-all duration-200 border-l-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600" data-route="lots" role="menuitem">
              <div class="flex items-center">
                <span class="material-symbols-outlined mr-3 text-lg">list_alt</span>
                <span class="font-medium flex-1">Lots & Tracking</span>
              </div>
            </a>
          </li>
          <li>
            <a href="#/workers" class="nav-link block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white transition-all duration-200 border-l-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600" data-route="workers" role="menuitem">
              <div class="flex items-center">
                <span class="material-symbols-outlined mr-3 text-lg">group</span>
                <span class="font-medium flex-1">Workers</span>
              </div>
            </a>
          </li>
          <li>
            <a href="#/admin" class="nav-link block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white transition-all duration-200 border-l-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600" data-route="admin" role="menuitem">
              <div class="flex items-center">
                <span class="material-symbols-outlined mr-3 text-lg">admin_panel_settings</span>
                <span class="font-medium flex-1">Admin</span>
              </div>
            </a>
          </li>
        </ul>
      </div>
    </div>
    
    <!-- Footer Navigation -->
    <div class="p-4 border-t border-gray-200 dark:border-gray-700 flex-shrink-0 mt-auto">
      <ul class="flex flex-col gap-y-1">
        <li>
          <a href="#/audit" class="nav-link block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white transition-all duration-200 border-l-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600" data-route="audit" role="menuitem">
            <div class="flex items-center">
              <span class="material-symbols-outlined mr-3 text-lg">description</span>
              <span class="font-medium flex-1">Audit Log</span>
            </div>
          </a>
        </li>
        <li>
          <a href="#/settings" class="nav-link block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white transition-all duration-200 border-l-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600" data-route="settings" role="menuitem">
            <div class="flex items-center">
              <span class="material-symbols-outlined mr-3 text-lg">settings</span>
              <span class="font-medium flex-1">Settings</span>
            </div>
          </a>
        </li>
      </ul>
    </div>
  </nav>
  
  <!-- Mobile close button -->
  <button id="mobile-close-btn" class="lg:hidden absolute top-4 right-4 p-2 rounded-lg text-gray-500 hover:text-gray-700 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">
    <span class="material-symbols-outlined">close</span>
  </button>
</aside>

<!-- Mobile Overlay -->
<div id="mobile-overlay" class="mobile-overlay lg:hidden"></div>

<header class="flex items-center justify-between px-3 sm:px-6 py-3 sm:py-4 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm border-b border-gray-200/50 dark:border-gray-700/50 sticky top-0 z-30">
  <!-- Mobile menu button and page title -->
  <div class="flex items-center gap-4">
    <!-- Only show mobile menu button on small screens when sidebar is hidden -->
    <button id="header-mobile-menu-btn" class="lg:hidden p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200">
      <span class="material-symbols-outlined">menu</span>
    </button>
    <div class="flex items-center gap-2 sm:gap-3">
      <h1 id="page-title" class="text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 dark:text-white truncate">Dashboard</h1>
      <!-- Breadcrumb navigation -->
      <nav class="hidden lg:flex items-center text-sm text-gray-500 dark:text-gray-400" aria-label="Breadcrumb">
        <span class="mx-2">/</span>
        <span id="breadcrumb-current" class="text-primary font-medium">Overview</span>
      </nav>
    </div>
  </div>
  
  <!-- Header controls -->
  <div class="flex items-center gap-1 sm:gap-3">
    <!-- Search -->
    <div class="hidden sm:block relative">
      <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 text-lg">search</span>
      <input 
        class="kevera-input pl-10 pr-4 py-2 w-40 sm:w-60 lg:w-80 text-sm" 
        placeholder="Search lots, workers, or templates..." 
        type="text"
        id="global-search"
      />
      <!-- Search suggestions dropdown -->
      <div id="search-suggestions" class="absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50">
        <div class="p-2">
          <div class="text-xs text-gray-500 dark:text-gray-400 px-3 py-2">Quick Actions</div>
          <a href="#/intake" class="flex items-center gap-3 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
            <span class="material-symbols-outlined text-lg">add</span>
            <span>New Intake</span>
          </a>
          <a href="#/lots" class="flex items-center gap-3 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
            <span class="material-symbols-outlined text-lg">list_alt</span>
            <span>View All Lots</span>
          </a>
        </div>
      </div>
    </div>
    
    <!-- Quick actions -->
    <button class="p-2 rounded-lg text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200 relative" title="Notifications">
      <span class="material-symbols-outlined">notifications</span>
      <span class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full text-xs text-white flex items-center justify-center" id="notification-badge">3</span>
    </button>
    
    <!-- Theme toggle -->
    <button id="theme-toggle" class="p-2 rounded-lg text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200" title="Toggle theme">
      <span class="material-symbols-outlined">dark_mode</span>
    </button>
    
    <!-- User menu -->
    <div class="relative">
      <button class="flex items-center gap-2 sm:gap-3 p-1 sm:p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200" id="user-menu-btn">
        <div class="w-7 h-7 sm:w-8 sm:h-8 bg-gradient-to-br from-primary to-teal-600 rounded-full flex items-center justify-center text-white font-semibold text-xs sm:text-sm">
          R
        </div>
        <div class="hidden sm:block text-left">
          <p class="text-sm font-medium text-gray-900 dark:text-white">Rhushi</p>
          <p class="text-xs text-gray-500 dark:text-gray-400">Production Manager</p>
        </div>
        <span class="material-symbols-outlined text-gray-400 hidden sm:inline">expand_more</span>
      </button>
      
      <!-- User dropdown menu -->
      <div id="user-menu" class="absolute right-0 top-full mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50">
        <div class="p-2">
          <div class="px-3 py-2 border-b border-gray-200 dark:border-gray-700">
            <p class="font-medium text-gray-900 dark:text-white">Rhushi</p>
            <p class="text-sm text-gray-500 dark:text-gray-400">rhushi@kevera.manufacturing</p>
          </div>
          <a href="#/profile" class="flex items-center gap-3 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg mt-2">
            <span class="material-symbols-outlined text-lg">person</span>
            <span>Profile</span>
          </a>
          <a href="#/settings" class="flex items-center gap-3 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
            <span class="material-symbols-outlined text-lg">settings</span>
            <span>Settings</span>
          </a>
          <div class="border-t border-gray-200 dark:border-gray-700 mt-2 pt-2">
            <button class="flex items-center gap-3 px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg w-full text-left">
              <span class="material-symbols-outlined text-lg">logout</span>
              <span>Sign Out</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>